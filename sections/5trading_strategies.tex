\chapter{\textcolor{red}{Trading Strategies}}\label{ch:predictions}

\section{\textcolor{red}{Trading Strategies - Introduction and Theory}}
\subsection{\textcolor{red}{Idea and Process}}
We compare different Trading Strategies. With the Goal of Predicting Stocks this is interesting in and of itself. For the purpose of the project it also serves as a baseline to compare our Trading Strategy against. 

Many of the following strategies crucially depend on the time frame that is used. Some strategies are supposed to work over longer time frames like months and years, others over shorter ones like days or weeks. In this sense, the time frame of a trading strategy is a hyperparameter to be optimized. We decided to use a fixed time frame of one day for all strategies. On the one hand, this allows for direct comparisons and reduces the risk of overfitting. On the other hand, it was simply not feasible for us to do this hyperparameter optimization for every strategy. 

\subsection{\textcolor{red}{Mean Reversion Models and Momentum Trading - Theoretical Background}}

A vast body of scientific literature has tried to develop models that allow to understand and explain movements in stock markets. An even vaster community of traders has tried to implement these theories to do actual forecasting. While many of the theories are much more complex, two basic ideas can be summarized as "Momentum Based Trading" and "Mean Reversion Based Trading". The former theory hypothesizes that stocks that do well now will likely continue to do so in the future while the latter states that especially good or past performance is an exception and that stocks will eventually return to their average performance. A third strategy, Pairs Trading, will be detailed later. 

In 1985 [Bondt and Thaler] were one of the early scholars to analyze mean reversion behaviour when they examined the hypothesis that markets tend to overreact. They looked at monthly returns of assets listed on the New York Stock Exchange in between 1926 and 1982 and constructed portfolios  of winners and losers that were updated every three years. Winners and losers were those stocks that had performed the best / worst over the previous years. Their idea was that "if stock prices systematically overshoot, then their reversal should be predictable from past return data alone, with no use of any accounting data such as earnings. [...] Extreme movements in stock prices will be followed by subsequent price movements in the opposite direction." Indeed they observed that the portfolio of losers outperformed the market significantly. While they focus on a very long time horizon of three years, Jagadeesh(1991) suggests that this behaviour could also be observed in the shorter term:  "These papers show that contrarian strategies that select stocks based on their returns in the previous week or month generate significant abnormal returns." 
While mean reversion behaviour has sometimes been observed in practice, it is not trivial to derive it from economic theory. Many economic theories like the famous model from Fama and French describe the return of the stocks of a company as the result of market properties like the baseline market return rate and inherent properties of that company, like for example its book-to-market-ratio [Fama and French 1993]. If such a relationship exists than this in turn implies that the actual observed stock movements should be random fluctuations around some much more slowly changing true return rate. However, it is unclear whether this mean reversion should happen in the form of a pendulum that swings forth and back or more in the form of coin tosses reverting to their equilibrium by flooding past observations with new random ones. 
Something about multiplicative connections?

On the opposite side of the spectrum of trading strategies lies the idea of momentum. [Japateesh and CX] in 1993 were one of the first to describe "that strategies which buy stocks that have performed well in the past and sell stocks that have performed poorly in the past generate significant positive returns over 3- to 12-month holding periods." [Japateesh and CX] looked at portfolios and saw mean reversion over 12 to 48 months. Thaler and Bondt observe mean reversion over the time frame of 36 months. Many scholares agree that mean reversion and momentum behaviour are not necessarily contradictions, but that the time frame determines in which way a stock will behave [Balvers and Wu]. 


PAIRS TRADING


\section{\textcolor{red}{Trading Strategies - Implementation}}
\subsection{\textcolor{red}{Mean Reversion Portfolio}}
While their analysis is focused on monthly returns over a much longer time frame, the basic idea that was replicated in our trading strategy was the same. The algorithm was implemented as follows: 

%\begin{Verbatim}[frame=single]
\begin{verbatim}
for day in all_days: 
    rank portfolio along their returns from the last day
    Buy the two worst performers
    sell (short) the two best performers
\end{verbatim}
%\end{Verbatim}

While Bondt and Thaler found excessive returns of that strategy from 1932 to 1977 our implementation was unforturnately much less successful. This may be due to the wrong time frame used or it might be due to either chance or alpha decay. If the strategy had indeed once been profitable we would assume enough market participants to trade on it as to render it practically useless. Figure \ref{fig:mean reversion} illustrates the performance of our mean-reversion portfolio against that of a simple buy-and-hold strategy. Interestingly, reverting the algorithm to buy the best performers and short the worst performers to produce a portfolio-based momentum strategy also does not work. 

\begin{figure}[h!]
    \centering
    \begin{adjustbox}{width=.95\textwidth,center}
        \input{figures/mean_reversion_portfolio_performance.pgf}
    \end{adjustbox}  
    \caption{Performance of the mean-reversion portfolio (orange) against the returns of a portfolio that had once been bought in the beginning and kept unchanged throughout (buy-and-hold, blue).}
    \label{fig:mean reversion}
\end{figure}{}

\subsection{\textcolor{red}{Mean Reversion - single stocks}}
For single stocks, we have tried two different ways to implement a mean reversion strategy. The first strategy looks at whether the current stock price is above or below its past mean. The second one in spirit does the same thing, but with log-returns. 

\subsubsection{Mean Reversion - Stock Prices}
The idea behind this strategy is that there is a true fundamental value underlying the stock that is represented by the mean of past stock prices. The trading strategy looks like this: 

\begin{verbatim}
for day in all_days: 
    cumulative_mean = cumulative mean of stock values until now
    if value of stock today > cumulative_mean:
        sell (short) the stock
    if value of stock today < cumulative_mean:
        buy the stock
\end{verbatim}

One obvious problem with this strategy is that any trend in the time series will be very poorly captured. Figure \ref{fig:mean_reversion_cum_mean} illustrates this by showing the time series plotted against their cumulative means (on the left) and the returns generated by trading on this strategy (on the right). 
\begin{figure}[h!]
    \centering
    \begin{minipage}[b]{0.49\textwidth}
        \centering
            \begin{adjustbox}{width=\textwidth,center}
                \input{figures/all_stock_price_cum_mean.pgf}
            \end{adjustbox}
        %\caption{Flower one.}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.49\textwidth}
        \centering
        \begin{adjustbox}{width=\textwidth,center}
            \input{figures/all_returns_cum_mean_strategy.pgf}
        \end{adjustbox}
        %\caption{Flower two.}
    \end{minipage}
    \caption{Caption}
    \label{fig:mean_reversion_cum_mean}
\end{figure}{}

One can try to alleviate this problem by not using the current value against the cumulative mean, but instead for example 30d and 60d averages. The strategy then looks like this: 

\begin{verbatim}
for day in all_days: 
    60d_mean = mean of stock values of the past 90 days
    30d_mean = mean of stock values of the past 30 days
    if 30d_mean > 60d_mean:
        sell (short) the stock
    if 30d_mean < 60d_mean:
        buy the stock
\end{verbatim}

Figure \ref{fig:30d_60d_plot} shows the 30d and 60d moving averages as well as the original time series on the left hand and the returns from the trading strategy on the right hand. While the plots on the left do look much better, the trading strategy is still not able to yield useful results. 

\begin{figure}[h!]
    \centering
    \begin{minipage}[b]{0.49\textwidth}
        \centering
            \begin{adjustbox}{width=\textwidth,center}
               % \input{figures/all_stock_30d_60d.pgf}
            \end{adjustbox}
        %\caption{Flower one.}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.49\textwidth}
        \centering
        \begin{adjustbox}{width=\textwidth,center}
            \input{figures/all_returns_cum_mean_strategy.pgf}
        \end{adjustbox}
        %\caption{Flower two.}
    \end{minipage}
    \caption{Caption}
    \label{fig:30d_60d_plot}
\end{figure}{}


\subsubsection{Mean Reversion - Log-Returns}
The second strategy looks at whether the current return is lower or higher than the cumulative mean of the time series. The algorithm looks as follows

%\begin{Verbatim}[frame=single]
\begin{verbatim}
for day in all_days: 
    cumulative_mean = cumulative mean of the time series until now
    if return today > cumulative_mean:
        sell (short) the stock
    if return today < cumulative_mean:
        buy the stock
\end{verbatim}
%\end{Verbatim}

One can of course easily replace the cumulative mean by e.g. the mean of the past 90, 60, or 30 days. 

\begin{figure}[h!]
    \centering
    \figuretitle{Returns from a Mean-Reversion Strategy}
    \begin{adjustbox}{width=.95\textwidth,center}
        \input{figures/all_returns_cum_mean_returns_strategy.pgf}
    \end{adjustbox}  
    \caption{Mean Reversion based on past returns for single stocks. The returns achieved by the strategy are in color, while the return of a simple buy-and-hold strategy, i.e. the return from a single share bought on the first day is shown in blue}
    \label{fig:mean_reversion_returns}
\end{figure}{}

\subsection{Momentum Based Trading}


\subsection{Pairs Trading}



\section{Trading Strategies Based on Our Predictions}



\section{Hybrid Trading Strategies}



